{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2>Carrito</h2>
  {% if items %}
    <form method="post" action="{% url 'productos:cart_checkout' %}">
      {% csrf_token %}
      <button class="btn btn-success">Pagar y comprar</button>
    </form>
  {% endif %}
</div>

{% if items %}
<div class="card">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table align-middle">
        <thead>
          <tr><th>Producto</th><th>Categoría</th><th>Cantidad</th><th>Precio</th><th>Subtotal</th></tr>
        </thead>
        <tbody>
          {% for item in items %}
          <tr>
            <td>{{ item.prod.nombre }}</td>
            <td class="text-muted">{{ item.prod.categoria.nombre }}</td>
            <td>{{ item.qty }}</td>
            <td>${{ item.prod.precio }}</td>
            <td><strong>${{ item.subtotal }}</strong></td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <div class="text-end">
      <h5>Total: ${{ total }}</h5>
    </div>
  </div>
</div>
<div class="cart-wrapper">
  <section class="cart-table">
    <!-- ...existing table/lista de items... -->
  </section>
  <aside class="cart-summary">
    <div class="cart-summary__row">
      <span>Subtotal</span>
      <span>${{ order_summary.subtotal|floatformat:2 }}</span>
    </div>
    <div class="cart-summary__row">
      <span>{{ order_summary.iva_label }}</span>
      <span>${{ order_summary.iva|floatformat:2 }}</span>
    </div>
    <div class="cart-summary__row cart-summary__total">
      <span>Total del pedido</span>
      <span>${{ order_summary.total|floatformat:2 }}</span>
    </div>
    <p class="text-muted small mb-0">{{ item_count }} artículo(s) en tu carrito.</p>
  </aside>
</div>
{% else %}
<div class="alert alert-info">Tu carrito está vacío.</div>
{% endif %}
{% endblock %}
